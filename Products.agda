{-# OPTIONS --type-in-type #-}

open import Prelude
open import Categories
open import Functors
open import Monics
open import Terminals


module Products (C : Category) where

----------------------------------------------------------------------------
-- Products
----------------------------------------------------------------------------

open Category C
open Iso C

record Product (A B : Obj) : Set where
  field
    A√óB : Obj
    œÄ‚ÇÄ : A√óB ~> A
    œÄ‚ÇÅ : A√óB ~> B
    ‚ü®_,_‚ü© : ‚àÄ {C} ‚Üí (C ~> A) ‚Üí (C ~> B) ‚Üí (C ~> A√óB)

    commute‚ÇÅ : ‚àÄ {X} {f : X ~> A} {g : X ~> B} ‚Üí ‚ü® f , g ‚ü© >~> œÄ‚ÇÄ ‚â° f
    commute‚ÇÇ : ‚àÄ {X} {f : X ~> A} {g : X ~> B} ‚Üí ‚ü® f , g ‚ü© >~> œÄ‚ÇÅ ‚â° g
    universal : ‚àÄ {X} {f : X ~> A} {g : X ~> B} {t : X ~> A√óB} ‚Üí
                   t >~> œÄ‚ÇÄ ‚â° f ‚Üí t >~> œÄ‚ÇÅ ‚â° g ‚Üí ‚ü® f , g ‚ü© ‚â° t

  œÄ-id : ‚ü® œÄ‚ÇÄ , œÄ‚ÇÅ ‚ü© ‚â° id~>
  œÄ-id = universal (law-id~>À° _) (law-id~>À° _)

  œÄ-Œ∑ : ‚àÄ {C} ‚Üí {f : C ~> A√óB} ‚Üí ‚ü® f >~> œÄ‚ÇÄ , f >~> œÄ‚ÇÅ ‚ü© ‚â° f
  œÄ-Œ∑ = universal refl refl

  pre-composing-with-tuple : {X Y : Obj} (i : Y ~> X) (f : X ~> A) (g : X ~> B) ‚Üí
                             i >~> ‚ü® f , g ‚ü© ‚â° ‚ü® i >~> f , i >~> g ‚ü©
  pre-composing-with-tuple i f g = sym (universal help‚ÇÅ help‚ÇÇ)
    where
      help‚ÇÅ : i >~> ‚ü® f , g ‚ü© >~> œÄ‚ÇÄ ‚â° i >~> f
      help‚ÇÅ = begin
        i >~> ‚ü® f , g¬†‚ü© >~> œÄ‚ÇÄ
       ‚â°‚ü® law->~> _ _ _ ‚ü©
        i >~> (‚ü® f , g ‚ü© >~> œÄ‚ÇÄ)
       ‚â°‚ü® whiskerÀ° commute‚ÇÅ ‚ü©
        i >~> f ‚ñ°
      help‚ÇÇ : i >~> ‚ü® f , g ‚ü© >~> œÄ‚ÇÅ ‚â° i >~> g
      help‚ÇÇ = begin
        i >~> ‚ü® f , g¬†‚ü© >~> œÄ‚ÇÅ
       ‚â°‚ü® law->~> _ _ _ ‚ü©
        i >~> (‚ü® f , g ‚ü© >~> œÄ‚ÇÅ)
       ‚â°‚ü® whiskerÀ° commute‚ÇÇ ‚ü©
        i >~> g ‚ñ°


up-to-iso : ‚àÄ {A B} ‚Üí (P Q : Product A B) ‚Üí Product.A√óB P ‚âÖ Product.A√óB Q
up-to-iso P Q = record { f = s
                       ; iso-witness = record { f ≥ = t
                                              ; inverse = begin
                                                  s >~> t
                                                 ‚â°‚ü® sym (Product.universal P lemmaP‚ÇÅ lemmaP‚ÇÇ) ‚ü©
                                                  Product.‚ü®_,_‚ü© P p‚ÇÄ p‚ÇÅ
                                                 ‚â°‚ü® Product.œÄ-id P ‚ü©
                                                  id~> ‚ñ°
                                              ; inverse ≥ = begin
                                                  t >~> s
                                                 ‚â°‚ü® sym (Product.universal Q lemmaQ‚ÇÅ lemmaQ‚ÇÇ) ‚ü©
                                                  Product.‚ü®_,_‚ü© Q q‚ÇÄ q‚ÇÅ
                                                 ‚â°‚ü® Product.œÄ-id Q ‚ü©
                                                  id~> ‚ñ°
                                              }
                       }
  where p‚ÇÄ = Product.œÄ‚ÇÄ P
        p‚ÇÅ = Product.œÄ‚ÇÅ P
        q‚ÇÄ = Product.œÄ‚ÇÄ Q
        q‚ÇÅ = Product.œÄ‚ÇÅ Q
        s = Product.‚ü®_,_‚ü© Q p‚ÇÄ p‚ÇÅ
        t = Product.‚ü®_,_‚ü© P q‚ÇÄ q‚ÇÅ
        lemmaP‚ÇÅ : s >~> t >~> p‚ÇÄ ‚â° p‚ÇÄ
        lemmaP‚ÇÅ = begin
          s >~> t >~> p‚ÇÄ
         ‚â°‚ü® law->~> _ _ _ ‚ü©
          s >~> (t >~> p‚ÇÄ)
         ‚â°‚ü® whiskerÀ° (Product.commute‚ÇÅ P) ‚ü©
          s >~> q‚ÇÄ
         ‚â°‚ü® Product.commute‚ÇÅ Q ‚ü©
          p‚ÇÄ ‚ñ°
        lemmaP‚ÇÇ : s >~> t >~> p‚ÇÅ ‚â° p‚ÇÅ
        lemmaP‚ÇÇ = begin
          s >~> t >~> p‚ÇÅ
         ‚â°‚ü® law->~> _ _ _ ‚ü©
          s >~> (t >~> p‚ÇÅ)
         ‚â°‚ü® whiskerÀ° (Product.commute‚ÇÇ P) ‚ü©
          s >~> q‚ÇÅ
         ‚â°‚ü® Product.commute‚ÇÇ Q ‚ü©
          p‚ÇÅ ‚ñ°
        lemmaQ‚ÇÅ : t >~> s >~> q‚ÇÄ ‚â° q‚ÇÄ
        lemmaQ‚ÇÅ = begin
          t >~> s >~> q‚ÇÄ
         ‚â°‚ü® law->~> _ _ _ ‚ü©
          t >~> (s >~> q‚ÇÄ)
         ‚â°‚ü® whiskerÀ° (Product.commute‚ÇÅ Q) ‚ü©
          t >~> p‚ÇÄ
         ‚â°‚ü® Product.commute‚ÇÅ P ‚ü©
          q‚ÇÄ ‚ñ°
        lemmaQ‚ÇÇ : t >~> s >~> q‚ÇÅ ‚â° q‚ÇÅ
        lemmaQ‚ÇÇ = begin
          t >~> s >~> q‚ÇÅ
         ‚â°‚ü® law->~> _ _ _ ‚ü©
          t >~> (s >~> q‚ÇÅ)
         ‚â°‚ü® whiskerÀ° (Product.commute‚ÇÇ Q) ‚ü©
          t >~> p‚ÇÅ
         ‚â°‚ü® Product.commute‚ÇÇ P ‚ü©
          q‚ÇÅ ‚ñ°


arrow-product : ‚àÄ {X Y A B} (P : Product X Y) (Q : Product A B) ‚Üí (f : X ~> A) (g : Y ~> B) ‚Üí Product.A√óB P ~> Product.A√óB Q
arrow-product P Q f g = Q.‚ü® (P.œÄ‚ÇÄ >~> f) , (P.œÄ‚ÇÅ >~> g) ‚ü©
  where module P = Product P
        module Q = Product Q


-√ó- : (p : (A B : Obj) ‚Üí Product A B) ‚Üí Prod C C => C
-√ó- p = record { ùîΩ‚ÇÄ = Œª {(a , b) ‚Üí Product.A√óB (p a b)}
               ; ùîΩ‚ÇÅ = Œª {(f , g) ‚Üí arrow-product (p _ _) (p _ _) f g}
               ; F-map-id~> = Œª { {A‚ÇÄ , A‚ÇÅ} ‚Üí
                   let open module A‚ÇÄ√óA‚ÇÅ = Product (p A‚ÇÄ A‚ÇÅ)
                   in begin
                      ‚ü® œÄ‚ÇÄ >~> id~> , œÄ‚ÇÅ >~> id~> ‚ü©
                     ‚â°‚ü® cong (Œª x ‚Üí ‚ü® x , œÄ‚ÇÅ >~> id~> ‚ü©) (law-id~> ≥ _) ‚ü©
                      ‚ü® œÄ‚ÇÄ , œÄ‚ÇÅ >~> id~> ‚ü©
                     ‚â°‚ü® cong (Œª x ‚Üí ‚ü® œÄ‚ÇÄ , x ‚ü©) (law-id~> ≥ _) ‚ü©
                      ‚ü® œÄ‚ÇÄ , œÄ‚ÇÅ ‚ü©
                     ‚â°‚ü® œÄ-id ‚ü©
                      id~> ‚ñ°
                 }
               ; F-map->~> = Œª { {A‚ÇÄ , A‚ÇÅ} {B‚ÇÄ , B‚ÇÅ} {C‚ÇÄ , C‚ÇÅ} (f‚ÇÄ , f‚ÇÅ) (g‚ÇÄ , g‚ÇÅ) ‚Üí
                   let module A‚ÇÄ√óA‚ÇÅ = Product (p A‚ÇÄ A‚ÇÅ)
                       module B‚ÇÄ√óB‚ÇÅ = Product (p B‚ÇÄ B‚ÇÅ)
                       module C‚ÇÄ√óC‚ÇÅ = Product (p C‚ÇÄ C‚ÇÅ)
                       f‚ÇÄ√óf‚ÇÅ = arrow-product (p _ _) (p _ _) f‚ÇÄ f‚ÇÅ
                       g‚ÇÄ√óg‚ÇÅ = arrow-product (p _ _) (p _ _) g‚ÇÄ g‚ÇÅ
                   in begin
                      C‚ÇÄ√óC‚ÇÅ.‚ü® A‚ÇÄ√óA‚ÇÅ.œÄ‚ÇÄ >~> (f‚ÇÄ >~> g‚ÇÄ) , A‚ÇÄ√óA‚ÇÅ.œÄ‚ÇÅ >~> (f‚ÇÅ >~> g‚ÇÅ) ‚ü©
                     ‚â°‚ü® cong (Œª x ‚Üí C‚ÇÄ√óC‚ÇÅ.‚ü® x , A‚ÇÄ√óA‚ÇÅ.œÄ‚ÇÅ >~> (f‚ÇÅ >~> g‚ÇÅ) ‚ü©) (sym (law->~> _ _ _)) ‚ü©
                      C‚ÇÄ√óC‚ÇÅ.‚ü® A‚ÇÄ√óA‚ÇÅ.œÄ‚ÇÄ >~> f‚ÇÄ >~> g‚ÇÄ , A‚ÇÄ√óA‚ÇÅ.œÄ‚ÇÅ >~> (f‚ÇÅ >~> g‚ÇÅ) ‚ü©
                     ‚â°‚ü® cong (Œª x ‚Üí C‚ÇÄ√óC‚ÇÅ.‚ü® A‚ÇÄ√óA‚ÇÅ.œÄ‚ÇÄ >~> f‚ÇÄ >~> g‚ÇÄ , x ‚ü©) (sym (law->~> _ _ _)) ‚ü©
                      C‚ÇÄ√óC‚ÇÅ.‚ü® A‚ÇÄ√óA‚ÇÅ.œÄ‚ÇÄ >~> f‚ÇÄ >~> g‚ÇÄ , A‚ÇÄ√óA‚ÇÅ.œÄ‚ÇÅ >~> f‚ÇÅ >~> g‚ÇÅ ‚ü©
                     ‚â°‚ü® cong (Œª x ‚Üí C‚ÇÄ√óC‚ÇÅ.‚ü® x >~> g‚ÇÄ , A‚ÇÄ√óA‚ÇÅ.œÄ‚ÇÅ >~> f‚ÇÅ >~> g‚ÇÅ ‚ü©) (sym B‚ÇÄ√óB‚ÇÅ.commute‚ÇÅ) ‚ü©
                      C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> B‚ÇÄ√óB‚ÇÅ.œÄ‚ÇÄ >~> g‚ÇÄ , A‚ÇÄ√óA‚ÇÅ.œÄ‚ÇÅ >~> f‚ÇÅ >~> g‚ÇÅ ‚ü©
                     ‚â°‚ü® cong (Œª x ‚Üí C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> B‚ÇÄ√óB‚ÇÅ.œÄ‚ÇÄ >~> g‚ÇÄ , x >~> g‚ÇÅ ‚ü©) (sym B‚ÇÄ√óB‚ÇÅ.commute‚ÇÇ) ‚ü©
                      C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> B‚ÇÄ√óB‚ÇÅ.œÄ‚ÇÄ >~> g‚ÇÄ , f‚ÇÄ√óf‚ÇÅ >~> B‚ÇÄ√óB‚ÇÅ.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü©
                     ‚â°‚ü® cong (Œª x ‚Üí C‚ÇÄ√óC‚ÇÅ.‚ü® x , f‚ÇÄ√óf‚ÇÅ >~> B‚ÇÄ√óB‚ÇÅ.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü©) (law->~> _ _ _) ‚ü©
                      C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> (B‚ÇÄ√óB‚ÇÅ.œÄ‚ÇÄ >~> g‚ÇÄ) , f‚ÇÄ√óf‚ÇÅ >~> B‚ÇÄ√óB‚ÇÅ.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü©
                     ‚â°‚ü® cong (Œª x ‚Üí C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> (B‚ÇÄ√óB‚ÇÅ.œÄ‚ÇÄ >~> g‚ÇÄ) , x ‚ü©) (law->~> _ _ _) ‚ü©
                      C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> (B‚ÇÄ√óB‚ÇÅ.œÄ‚ÇÄ >~> g‚ÇÄ) , f‚ÇÄ√óf‚ÇÅ >~> (B‚ÇÄ√óB‚ÇÅ.œÄ‚ÇÅ >~> g‚ÇÅ) ‚ü©
                     ‚â°‚ü® cong (Œª x ‚Üí C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> x , f‚ÇÄ√óf‚ÇÅ >~> (B‚ÇÄ√óB‚ÇÅ.œÄ‚ÇÅ >~> g‚ÇÅ) ‚ü©) (sym C‚ÇÄ√óC‚ÇÅ.commute‚ÇÅ) ‚ü©
                      C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> (g‚ÇÄ√óg‚ÇÅ >~> C‚ÇÄ√óC‚ÇÅ.œÄ‚ÇÄ) , f‚ÇÄ√óf‚ÇÅ >~> (B‚ÇÄ√óB‚ÇÅ.œÄ‚ÇÅ >~> g‚ÇÅ) ‚ü©
                     ‚â°‚ü® cong (Œª x ‚Üí C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> (g‚ÇÄ√óg‚ÇÅ >~> C‚ÇÄ√óC‚ÇÅ.œÄ‚ÇÄ) , f‚ÇÄ√óf‚ÇÅ >~> x ‚ü©) (sym C‚ÇÄ√óC‚ÇÅ.commute‚ÇÇ) ‚ü©
                      C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> (g‚ÇÄ√óg‚ÇÅ >~> C‚ÇÄ√óC‚ÇÅ.œÄ‚ÇÄ) , f‚ÇÄ√óf‚ÇÅ >~> (g‚ÇÄ√óg‚ÇÅ >~> C‚ÇÄ√óC‚ÇÅ.œÄ‚ÇÅ) ‚ü©
                     ‚â°‚ü® cong (Œª x ‚Üí C‚ÇÄ√óC‚ÇÅ.‚ü® x , f‚ÇÄ√óf‚ÇÅ >~> (g‚ÇÄ√óg‚ÇÅ >~> C‚ÇÄ√óC‚ÇÅ.œÄ‚ÇÅ) ‚ü©) (sym (law->~> _ _ _)) ‚ü©
                      C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> g‚ÇÄ√óg‚ÇÅ >~> C‚ÇÄ√óC‚ÇÅ.œÄ‚ÇÄ , f‚ÇÄ√óf‚ÇÅ >~> (g‚ÇÄ√óg‚ÇÅ >~> C‚ÇÄ√óC‚ÇÅ.œÄ‚ÇÅ) ‚ü©
                     ‚â°‚ü® cong (Œª x ‚Üí C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> g‚ÇÄ√óg‚ÇÅ >~> C‚ÇÄ√óC‚ÇÅ.œÄ‚ÇÄ , x ‚ü©) (sym (law->~> _ _ _)) ‚ü©
                      C‚ÇÄ√óC‚ÇÅ.‚ü® f‚ÇÄ√óf‚ÇÅ >~> g‚ÇÄ√óg‚ÇÅ >~> C‚ÇÄ√óC‚ÇÅ.œÄ‚ÇÄ , f‚ÇÄ√óf‚ÇÅ >~> g‚ÇÄ√óg‚ÇÅ >~> C‚ÇÄ√óC‚ÇÅ.œÄ‚ÇÅ ‚ü©
                     ‚â°‚ü® C‚ÇÄ√óC‚ÇÅ.œÄ-Œ∑ ‚ü©
                      f‚ÇÄ√óf‚ÇÅ >~> g‚ÇÄ√óg‚ÇÅ ‚ñ°
                 }
               }

post-composing-arrow-product : ‚àÄ {X A‚ÇÄ A‚ÇÅ B‚ÇÄ B‚ÇÅ} (P : Product A‚ÇÄ A‚ÇÅ) (Q : Product B‚ÇÄ B‚ÇÅ) ‚Üí
                               (f‚ÇÄ : X ~> A‚ÇÄ) (f‚ÇÅ : X ~> A‚ÇÅ) ‚Üí
                               (g‚ÇÄ : A‚ÇÄ ~> B‚ÇÄ) (g‚ÇÅ : A‚ÇÅ ~> B‚ÇÅ) ‚Üí
                               (Product.‚ü®_,_‚ü© P f‚ÇÄ f‚ÇÅ) >~> (arrow-product P Q g‚ÇÄ g‚ÇÅ) ‚â° Product.‚ü®_,_‚ü© Q (f‚ÇÄ >~> g‚ÇÄ) (f‚ÇÅ >~> g‚ÇÅ)
post-composing-arrow-product P Q f‚ÇÄ f‚ÇÅ g‚ÇÄ g‚ÇÅ = begin
  P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> arrow-product P Q g‚ÇÄ g‚ÇÅ
 ‚â°‚ü® sym Q.œÄ-Œ∑ ‚ü©
  Q.‚ü® P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> Q.‚ü® P.œÄ‚ÇÄ >~> g‚ÇÄ , P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü© >~> Q.œÄ‚ÇÄ , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> Q.‚ü® P.œÄ‚ÇÄ >~> g‚ÇÄ , P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü© >~> Q.œÄ‚ÇÅ ‚ü©
 ‚â°‚ü® cong (Œª x ‚Üí Q.‚ü® x , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> Q.‚ü® P.œÄ‚ÇÄ >~> g‚ÇÄ , P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü© >~> Q.œÄ‚ÇÅ ‚ü©) (law->~> _ _ _) ‚ü©
  Q.‚ü® P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> (Q.‚ü® P.œÄ‚ÇÄ >~> g‚ÇÄ , P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü© >~> Q.œÄ‚ÇÄ) , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> Q.‚ü® P.œÄ‚ÇÄ >~> g‚ÇÄ , P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü© >~> Q.œÄ‚ÇÅ ‚ü©
 ‚â°‚ü® cong (Œª x ‚Üí Q.‚ü® P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> (Q.‚ü® P.œÄ‚ÇÄ >~> g‚ÇÄ , P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü© >~> Q.œÄ‚ÇÄ) , x ‚ü©) (law->~> _ _ _) ‚ü©
  Q.‚ü® P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> (Q.‚ü® P.œÄ‚ÇÄ >~> g‚ÇÄ , P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü© >~> Q.œÄ‚ÇÄ) , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> (Q.‚ü® P.œÄ‚ÇÄ >~> g‚ÇÄ , P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü© >~> Q.œÄ‚ÇÅ) ‚ü©
 ‚â°‚ü® cong (Œª x ‚Üí Q.‚ü® P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> x , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> (Q.‚ü® P.œÄ‚ÇÄ >~> g‚ÇÄ , P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü© >~> Q.œÄ‚ÇÅ) ‚ü©) Q.commute‚ÇÅ ‚ü©
  Q.‚ü® P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> (P.œÄ‚ÇÄ >~> g‚ÇÄ) , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> (Q.‚ü® P.œÄ‚ÇÄ >~> g‚ÇÄ , P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü© >~> Q.œÄ‚ÇÅ) ‚ü©
 ‚â°‚ü® cong (Œª x ‚Üí Q.‚ü® P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> (P.œÄ‚ÇÄ >~> g‚ÇÄ) , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> x ‚ü©) Q.commute‚ÇÇ ‚ü©
  Q.‚ü® P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> (P.œÄ‚ÇÄ >~> g‚ÇÄ) , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> (P.œÄ‚ÇÅ >~> g‚ÇÅ) ‚ü©
 ‚â°‚ü® cong (Œª x ‚Üí Q.‚ü® x , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> (P.œÄ‚ÇÅ >~> g‚ÇÅ) ‚ü©) (sym (law->~> _ _ _)) ‚ü©
  Q.‚ü® P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> P.œÄ‚ÇÄ >~> g‚ÇÄ , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> (P.œÄ‚ÇÅ >~> g‚ÇÅ) ‚ü©
 ‚â°‚ü® cong (Œª x ‚Üí Q.‚ü® P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> P.œÄ‚ÇÄ >~> g‚ÇÄ , x ‚ü©) (sym (law->~> _ _ _)) ‚ü©
  Q.‚ü® P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> P.œÄ‚ÇÄ >~> g‚ÇÄ , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü©
 ‚â°‚ü® cong (Œª x ‚Üí Q.‚ü® x >~> g‚ÇÄ , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü©) P.commute‚ÇÅ ‚ü©
  Q.‚ü® f‚ÇÄ >~> g‚ÇÄ , P.‚ü® f‚ÇÄ , f‚ÇÅ ‚ü© >~> P.œÄ‚ÇÅ >~> g‚ÇÅ ‚ü©
 ‚â°‚ü® cong (Œª x ‚Üí Q.‚ü® f‚ÇÄ >~> g‚ÇÄ , x >~> g‚ÇÅ ‚ü©) P.commute‚ÇÇ ‚ü©
  Q.‚ü® f‚ÇÄ >~> g‚ÇÄ , f‚ÇÅ >~> g‚ÇÅ ‚ü© ‚ñ°

  where module P = Product P
        module Q = Product Q


product-associator : ‚àÄ {A B C} ‚Üí
                     (P‚ÇÅ : Product A B) (P‚ÇÇ : Product B C)
                     (P‚ÇÉ : Product A (Product.A√óB P‚ÇÇ)) (P‚ÇÑ : Product (Product.A√óB P‚ÇÅ) C) ‚Üí
                     Product.A√óB P‚ÇÉ ‚âÖ Product.A√óB P‚ÇÑ
product-associator P‚ÇÅ P‚ÇÇ P‚ÇÉ P‚ÇÑ =
  record { f = s
         ; iso-witness =
             record { f ≥ = t
                    ; inverse = begin
                       s >~> t
                      ‚â°‚ü® P‚ÇÉ.pre-composing-with-tuple s (P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ) (P‚ÇÇ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÑ.œÄ‚ÇÅ ‚ü©) ‚ü©
                       P‚ÇÉ.‚ü® s >~> (P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ) , s >~> P‚ÇÇ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÉ.‚ü® s >~> (P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ) , x ‚ü©) (P‚ÇÇ.pre-composing-with-tuple s (P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ) P‚ÇÑ.œÄ‚ÇÅ) ‚ü©
                       P‚ÇÉ.‚ü® s >~> (P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ) , P‚ÇÇ.‚ü® s >~> (P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ) , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÉ.‚ü® x , P‚ÇÇ.‚ü® s >~> (P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ) , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©) (sym (law->~> _ _ _)) ‚ü©
                       P‚ÇÉ.‚ü® s >~> P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® s >~> (P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ) , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÉ.‚ü® s >~> P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® x , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©) (sym (law->~> _ _ _)) ‚ü©
                       P‚ÇÉ.‚ü® s >~> P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® s >~> P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÉ.‚ü® x >~> P‚ÇÅ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® s >~> P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©) P‚ÇÑ.commute‚ÇÅ ‚ü©
                       P‚ÇÉ.‚ü® P‚ÇÅ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ ‚ü© >~> P‚ÇÅ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® s >~> P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÉ.‚ü® x , P‚ÇÇ.‚ü® s >~> P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©) P‚ÇÅ.commute‚ÇÅ ‚ü©
                       P‚ÇÉ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® s >~> P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÉ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® x >~> P‚ÇÅ.œÄ‚ÇÅ , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©) P‚ÇÑ.commute‚ÇÅ ‚ü©
                       P‚ÇÉ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® P‚ÇÅ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ ‚ü© >~> P‚ÇÅ.œÄ‚ÇÅ , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÉ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® x , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©) P‚ÇÅ.commute‚ÇÇ ‚ü©
                       P‚ÇÉ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ , s >~> P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÉ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ , x ‚ü© ‚ü©) P‚ÇÑ.commute‚ÇÇ ‚ü©
                       P‚ÇÉ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ , P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ ‚ü© ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÉ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , x ‚ü©) P‚ÇÇ.œÄ-Œ∑ ‚ü©
                       P‚ÇÉ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÉ.œÄ‚ÇÅ ‚ü©
                      ‚â°‚ü® P‚ÇÉ.œÄ-id ‚ü©
                       id~> ‚ñ°

                    ; inverse ≥ = begin
                       t >~> s
                      ‚â°‚ü® P‚ÇÑ.pre-composing-with-tuple t (P‚ÇÅ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ ‚ü©) (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ)  ‚ü©
                       P‚ÇÑ.‚ü® t >~> P‚ÇÅ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ ‚ü© , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÑ.‚ü® x , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©) (P‚ÇÅ.pre-composing-with-tuple t P‚ÇÉ.œÄ‚ÇÄ (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ)) ‚ü©
                       P‚ÇÑ.‚ü® P‚ÇÅ.‚ü® t >~> P‚ÇÉ.œÄ‚ÇÄ , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ) ‚ü© , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÑ.‚ü® P‚ÇÅ.‚ü® x , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ) ‚ü© , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©) P‚ÇÉ.commute‚ÇÅ ‚ü©
                       P‚ÇÑ.‚ü® P‚ÇÅ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ) ‚ü© , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÑ.‚ü® P‚ÇÅ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ , x ‚ü© , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©) (sym (law->~> _ _ _)) ‚ü©
                       P‚ÇÑ.‚ü® P‚ÇÅ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ , t >~> P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ ‚ü© , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÑ.‚ü® P‚ÇÅ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ , x >~> P‚ÇÇ.œÄ‚ÇÄ ‚ü© , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©) (P‚ÇÉ.commute‚ÇÇ) ‚ü©
                       P‚ÇÑ.‚ü® P‚ÇÅ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÑ.œÄ‚ÇÅ ‚ü© >~> P‚ÇÇ.œÄ‚ÇÄ ‚ü© , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÑ.‚ü® P‚ÇÅ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ , x ‚ü© , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©) P‚ÇÇ.commute‚ÇÅ ‚ü©
                       P‚ÇÑ.‚ü® P‚ÇÅ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ , P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ ‚ü© , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÑ.‚ü® x , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©) P‚ÇÅ.œÄ-Œ∑ ‚ü©
                       P‚ÇÑ.‚ü® P‚ÇÑ.œÄ‚ÇÄ , t >~> (P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ) ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÑ.‚ü® P‚ÇÑ.œÄ‚ÇÄ , x ‚ü©) (sym (law->~> _ _ _)) ‚ü©
                       P‚ÇÑ.‚ü® P‚ÇÑ.œÄ‚ÇÄ , t >~> P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÑ.‚ü® P‚ÇÑ.œÄ‚ÇÄ , x >~> P‚ÇÇ.œÄ‚ÇÅ ‚ü©) P‚ÇÉ.commute‚ÇÇ ‚ü©
                       P‚ÇÑ.‚ü® P‚ÇÑ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÑ.œÄ‚ÇÅ ‚ü© >~> P‚ÇÇ.œÄ‚ÇÅ ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÑ.‚ü® P‚ÇÑ.œÄ‚ÇÄ , x ‚ü©) P‚ÇÇ.commute‚ÇÇ ‚ü©
                       P‚ÇÑ.‚ü® P‚ÇÑ.œÄ‚ÇÄ , P‚ÇÑ.œÄ‚ÇÅ ‚ü©
                      ‚â°‚ü® P‚ÇÑ.œÄ-id ‚ü©
                       id~> ‚ñ°
                     }
         }
  where module P‚ÇÅ = Product P‚ÇÅ
        module P‚ÇÇ = Product P‚ÇÇ
        module P‚ÇÉ = Product P‚ÇÉ
        module P‚ÇÑ = Product P‚ÇÑ
        s = P‚ÇÑ.‚ü® P‚ÇÅ.‚ü® P‚ÇÉ.œÄ‚ÇÄ , P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÄ ‚ü© , P‚ÇÉ.œÄ‚ÇÅ >~> P‚ÇÇ.œÄ‚ÇÅ ‚ü©
        t = P‚ÇÉ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® P‚ÇÑ.œÄ‚ÇÄ >~> P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÑ.œÄ‚ÇÅ ‚ü© ‚ü©


product-unitor : (T : Terminal C) (A : Obj) (P : Product (Terminal.ùüô T) A) ‚Üí Product.A√óB P ‚âÖ A
product-unitor T A P =
  record { f = œÄ‚ÇÅ
         ; iso-witness =
             record { f ≥ = ‚ü® ! , id~> ‚ü©
                    ; inverse = begin
                       œÄ‚ÇÅ >~> ‚ü® ! , id~> ‚ü©
                      ‚â°‚ü® pre-composing-with-tuple œÄ‚ÇÅ ! id~> ‚ü©
                       ‚ü® œÄ‚ÇÅ >~> ! , œÄ‚ÇÅ >~> id~> ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí ‚ü® œÄ‚ÇÅ >~> ! , x ‚ü©) (law-id~> ≥ _) ‚ü©
                       ‚ü® œÄ‚ÇÅ >~> ! , œÄ‚ÇÅ ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí ‚ü® x , œÄ‚ÇÅ ‚ü©) (lemma T œÄ‚ÇÅ) ‚ü©
                       ‚ü® ! , œÄ‚ÇÅ ‚ü©
                      ‚â°‚ü® cong (Œª x ‚Üí ‚ü® x , œÄ‚ÇÅ ‚ü©) (sym (!-unique œÄ‚ÇÄ)) ‚ü©
                       ‚ü® œÄ‚ÇÄ , œÄ‚ÇÅ ‚ü©
                      ‚â°‚ü® œÄ-id ‚ü©
                       id~> ‚ñ°
                    ; inverse ≥ = commute‚ÇÇ }
                    }
  where open Terminal T
        open Product P
        open pre-composing-with-bang

product-symmetry : ‚àÄ {A B} (P‚ÇÅ : Product A B) (P‚ÇÇ : Product B A) ‚Üí Product.A√óB P‚ÇÅ ‚âÖ Product.A√óB P‚ÇÇ
product-symmetry P‚ÇÅ P‚ÇÇ =
  record { f = P‚ÇÇ.‚ü® P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÅ.œÄ‚ÇÄ ‚ü©
         ; iso-witness = record { f ≥ = P‚ÇÅ.‚ü® P‚ÇÇ.œÄ‚ÇÅ , P‚ÇÇ.œÄ‚ÇÄ ‚ü©
                                ; inverse = begin
                                     P‚ÇÇ.‚ü® P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÅ.œÄ‚ÇÄ ‚ü© >~> P‚ÇÅ.‚ü® P‚ÇÇ.œÄ‚ÇÅ , P‚ÇÇ.œÄ‚ÇÄ ‚ü©
                                    ‚â°‚ü® P‚ÇÅ.pre-composing-with-tuple (P‚ÇÇ.‚ü® P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÅ.œÄ‚ÇÄ ‚ü©) P‚ÇÇ.œÄ‚ÇÅ P‚ÇÇ.œÄ‚ÇÄ ‚ü©
                                     P‚ÇÅ.‚ü® P‚ÇÇ.‚ü® P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÅ.œÄ‚ÇÄ ‚ü© >~> P‚ÇÇ.œÄ‚ÇÅ , P‚ÇÇ.‚ü® P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÅ.œÄ‚ÇÄ ‚ü© >~> P‚ÇÇ.œÄ‚ÇÄ ‚ü©
                                    ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÅ.‚ü® x , P‚ÇÇ.‚ü® P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÅ.œÄ‚ÇÄ ‚ü© >~> P‚ÇÇ.œÄ‚ÇÄ ‚ü©) P‚ÇÇ.commute‚ÇÇ ‚ü©
                                     P‚ÇÅ.‚ü® P‚ÇÅ.œÄ‚ÇÄ , P‚ÇÇ.‚ü® P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÅ.œÄ‚ÇÄ ‚ü© >~> P‚ÇÇ.œÄ‚ÇÄ ‚ü©
                                    ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÅ.‚ü® P‚ÇÅ.œÄ‚ÇÄ , x ‚ü©) P‚ÇÇ.commute‚ÇÅ ‚ü©
                                     P‚ÇÅ.‚ü® P‚ÇÅ.œÄ‚ÇÄ , P‚ÇÅ.œÄ‚ÇÅ ‚ü©
                                    ‚â°‚ü® P‚ÇÅ.œÄ-id ‚ü©
                                     id~> ‚ñ°
                                ; inverse ≥ = begin
                                    P‚ÇÅ.‚ü® P‚ÇÇ.œÄ‚ÇÅ , P‚ÇÇ.œÄ‚ÇÄ ‚ü© >~> P‚ÇÇ.‚ü® P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÅ.œÄ‚ÇÄ ‚ü©
                                   ‚â°‚ü® P‚ÇÇ.pre-composing-with-tuple (P‚ÇÅ.‚ü® P‚ÇÇ.œÄ‚ÇÅ , P‚ÇÇ.œÄ‚ÇÄ ‚ü©) P‚ÇÅ.œÄ‚ÇÅ P‚ÇÅ.œÄ‚ÇÄ ‚ü©
                                    P‚ÇÇ.‚ü® P‚ÇÅ.‚ü® P‚ÇÇ.œÄ‚ÇÅ , P‚ÇÇ.œÄ‚ÇÄ ‚ü© >~> P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÅ.‚ü® P‚ÇÇ.œÄ‚ÇÅ , P‚ÇÇ.œÄ‚ÇÄ ‚ü© >~> P‚ÇÅ.œÄ‚ÇÄ ‚ü©
                                   ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÇ.‚ü® P‚ÇÅ.‚ü® P‚ÇÇ.œÄ‚ÇÅ , P‚ÇÇ.œÄ‚ÇÄ ‚ü© >~> P‚ÇÅ.œÄ‚ÇÅ , x ‚ü©) P‚ÇÅ.commute‚ÇÅ ‚ü©
                                    P‚ÇÇ.‚ü® P‚ÇÅ.‚ü® P‚ÇÇ.œÄ‚ÇÅ , P‚ÇÇ.œÄ‚ÇÄ ‚ü© >~> P‚ÇÅ.œÄ‚ÇÅ , P‚ÇÇ.œÄ‚ÇÅ ‚ü©
                                   ‚â°‚ü® cong (Œª x ‚Üí P‚ÇÇ.‚ü® x , P‚ÇÇ.œÄ‚ÇÅ ‚ü©) P‚ÇÅ.commute‚ÇÇ ‚ü©
                                    P‚ÇÇ.‚ü® P‚ÇÇ.œÄ‚ÇÄ , P‚ÇÇ.œÄ‚ÇÅ ‚ü©
                                   ‚â°‚ü® P‚ÇÇ.œÄ-id ‚ü©
                                    id~> ‚ñ°
                                }
         }
  where module P‚ÇÅ = Product P‚ÇÅ
        module P‚ÇÇ = Product P‚ÇÇ
